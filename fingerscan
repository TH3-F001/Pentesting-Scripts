#!/bin/bash
#
# TO DO:
# 	+ Implement option to only scan specified ports
# 	+ Implement switch to enable stealth mode
# 		(Stealth mode would wait semi random intervals within a certain minimum threshold
# 		 as well as scan ports randomly instead of sequentially)
#

TIMEOUT=5
TARGET=$1
OUTFILE="fingerscan_${TARGET}.txt"
if [ -e $OUTFILE ]; then
	echo "" > $OUTFILE
fi
for i in {1..65535};do
	OUT=$(timeout $TIMEOUT bash -c "echo 'GET / HTTP/1.1' | nc $TARGET $i < /dev/null")
	EC=$?
	if [ -n "$OUT" ]; then
		echo "[$i] $OUT" | tee -a $OUTFILE 
	elif  [ $EC -eq 124 ]; then
		echo "[$i] Sussy Port Detected <$EC>" | tee -a $OUTFILE 
	else
		echo "No response on port $i"
	fi

done
